-----BEGIN CERTIFICATE-----
PD9waHAKCm5hbWVzcGFjZSBBcHBcSHR0cFxDb250cm9sbGVyczsKCnVzZSBJbGx1
bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcFxNb2RlbHNcVmVudGE7CnVzZSBB
cHBcTW9kZWxzXENsaWVudGU7CnVzZSBBcHBcTW9kZWxzXFVzZXI7CnVzZSBBcHBc
TW9kZWxzXENhamE7CnVzZSBBcHBcTW9kZWxzXE1ldG9kb1BhZ287CnVzZSBBcHBc
TW9kZWxzXFByb2R1Y3RvOwp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XEZhY2FkZXNc
REI7CnVzZSBBcHBcTW9kZWxzXERldGFsbGVWZW50YTsKdXNlIElsbHVtaW5hdGVc
U3VwcG9ydFxGYWNhZGVzXExvZzsKdXNlIElsbHVtaW5hdGVcU3VwcG9ydFxGYWNh
ZGVzXHZhbGlkYXRvcjsKdXNlIElsbHVtaW5hdGVcVmFsaWRhdGlvblxWYWxpZGF0
aW9uRXhjZXB0aW9uOwp1c2UgVGhyb3dhYmxlOwoKCmNsYXNzIFZlbnRhQ29udHJv
bGxlciBleHRlbmRzIENvbnRyb2xsZXIKewoKICAgIHB1YmxpYyBmdW5jdGlvbiBp
bmRleCgpCiAgICB7CiAgICAgICAgJHZlbnRhcyA9IFZlbnRhOjp3aXRoKFsnY2xp
ZW50ZScsICd1c2VyJywgJ21ldG9kb1BhZ28nLCAnZGV0YWxsZXMucHJvZHVjdG8n
XSktPm9yZGVyQnkoJ2lkJywgJ2Rlc2MnKS0+cGFnaW5hdGUoMTApOwogICAgICAg
ICRwcm9kdWN0b3MgPSBQcm9kdWN0bzo6YWxsKCk7CiAgICAgICAgJGNsaWVudGVz
ID0gQ2xpZW50ZTo6YWxsKCk7CiAgICAgICAgJHVzdWFyaW9zID0gVXNlcjo6YWxs
KCk7CiAgICAgICAgJG1ldG9kb3NQYWdvID0gTWV0b2RvUGFnbzo6YWxsKCk7Cgog
ICAgICAgIGlmIChhdXRoKCktPnVzZXIoKS0+cm9sZSA9PT0gJ2FkbWluJykgewog
ICAgICAgICAgICByZXR1cm4gdmlldygnYWRtaW4udmVudGFzLmluZGV4JywgY29t
cGFjdCgndmVudGFzJywgJ2NsaWVudGVzJywgJ3VzdWFyaW9zJywgJ21ldG9kb3NQ
YWdvJywgJ3Byb2R1Y3RvcycpKTsKICAgICAgICB9IGVsc2VpZiAoYXV0aCgpLT51
c2VyKCktPnJvbGUgPT09ICdlbXBsZWFkbycpIHsKICAgICAgICAgICAgcmV0dXJu
IHZpZXcoJ2VtcGxlYWRvLnZlbnRhcy5pbmRleCcsIGNvbXBhY3QoJ3ZlbnRhcycs
ICdjbGllbnRlcycsICd1c3VhcmlvcycsICdtZXRvZG9zUGFnbycsICdwcm9kdWN0
b3MnKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWJvcnQoNDAzLCAn
Tm8gdGllbmVzIHBlcm1pc28gcGFyYSBhY2NlZGVyIGEgZXN0YSBzZWNjacOzbi4n
KTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJl
cXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgLy8gRnVlcnphIHJlc3B1ZXN0
YSBKU09OIHBhcmEgZmV0Y2gvWEhSCiAgICAgICAgJHJlcXVlc3QtPmhlYWRlcnMt
PnNldCgnQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTsKCiAgICAgICAgLy8g
VmFsaWRhY2nDs24gKExhcmF2ZWwgZGV2b2x2ZXLDoSA0MjIgSlNPTiBzaSBmYWxs
YSkKICAgICAgICAkZGF0YSA9ICRyZXF1ZXN0LT52YWxpZGF0ZShbCiAgICAgICAg
ICAgICdjbGllbnRlX2lkJyAgICAgID0+ICdyZXF1aXJlZHxleGlzdHM6Y2xpZW50
ZXMsaWQnLAogICAgICAgICAgICAndXNlcl9pZCcgICAgICAgICA9PiAncmVxdWly
ZWR8ZXhpc3RzOnVzZXJzLGlkJywKICAgICAgICAgICAgJ21ldG9kb19wYWdvX2lk
JyAgPT4gJ3JlcXVpcmVkfGV4aXN0czptZXRvZG9zX3BhZ28saWQnLAogICAgICAg
ICAgICAndG90YWwnICAgICAgICAgICA9PiAncmVxdWlyZWR8bnVtZXJpY3xtaW46
MCcsIC8vIHZhbGlkYW1vcywgcGVybyBubyBjb25maWFtb3MgcGFyYSBndWFyZGFy
CgogICAgICAgICAgICAnaXRlbXMnICAgICAgICAgICAgICAgICAgICAgICA9PiAn
cmVxdWlyZWR8YXJyYXl8bWluOjEnLAogICAgICAgICAgICAnaXRlbXMuKi5pZF9w
cm9kdWN0bycgICAgICAgICA9PiAncmVxdWlyZWR8ZXhpc3RzOnByb2R1Y3Rvcyxp
ZHxkaXN0aW5jdCcsCiAgICAgICAgICAgICdpdGVtcy4qLmNhbnRpZGFkJyAgICAg
ICAgICAgID0+ICdyZXF1aXJlZHxpbnRlZ2VyfG1pbjoxJywKICAgICAgICAgICAg
J2l0ZW1zLiouc3VidG90YWwnICAgICAgICAgICAgPT4gJ3JlcXVpcmVkfG51bWVy
aWN8bWluOjAnLAogICAgICAgICAgICAnaXRlbXMuKi5kZXNjdWVudG8nICAgICAg
ICAgID0+ICdyZXF1aXJlZHxudW1lcmljfG1pbjowJywKICAgICAgICBdLCBbCiAg
ICAgICAgICAgICdpdGVtcy5yZXF1aXJlZCcgPT4gJ0FncmVndWUgYWwgbWVub3Mg
dW4gw610ZW0uJywKICAgICAgICBdKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAg
ICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKCiAgICAgICAgICAgIC8vIENyZWFt
b3MgY2FiZWNlcmEgY29uIHRvdGFsIDA7IHNlIHJlY2FsY3VsYXLDoQogICAgICAg
ICAgICAkdmVudGEgPSBWZW50YTo6Y3JlYXRlKFsKICAgICAgICAgICAgICAgICdj
bGllbnRlX2lkJyAgICAgPT4gKGludCkkZGF0YVsnY2xpZW50ZV9pZCddLAogICAg
ICAgICAgICAgICAgJ3VzZXJfaWQnICAgICAgICA9PiAoaW50KSRkYXRhWyd1c2Vy
X2lkJ10sCiAgICAgICAgICAgICAgICAnbWV0b2RvX3BhZ29faWQnID0+IChpbnQp
JGRhdGFbJ21ldG9kb19wYWdvX2lkJ10sCiAgICAgICAgICAgICAgICAndG90YWwn
ICAgICAgICAgID0+IDAsCiAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgZm9y
ZWFjaCAoJGRhdGFbJ2l0ZW1zJ10gYXMgJGlkeCA9PiAkaXRlbSkgewogICAgICAg
ICAgICAgICAgJHByb2R1Y3RvID0gUHJvZHVjdG86OmxvY2tGb3JVcGRhdGUoKS0+
ZmluZCgkaXRlbVsnaWRfcHJvZHVjdG8nXSk7CiAgICAgICAgICAgICAgICBpZiAo
ISRwcm9kdWN0bykgewogICAgICAgICAgICAgICAgICAgIHRocm93IFZhbGlkYXRp
b25FeGNlcHRpb246OndpdGhNZXNzYWdlcyhbCiAgICAgICAgICAgICAgICAgICAg
ICAgICJpdGVtcy4kaWR4LmlkX3Byb2R1Y3RvIiA9PiBbIlByb2R1Y3RvIG5vIGRp
c3BvbmlibGUuIl0sCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAg
ICAgICB9CgogICAgICAgICAgICAgICAgJGRlc2N1ZW50byAgID0gKGZsb2F0KSgk
aXRlbVsnZGVzY3VlbnRvJ10gPz8gMCk7CiAgICAgICAgICAgICAgICAkY2FudGlk
YWQgICAgPSAoaW50KSgkaXRlbVsnY2FudGlkYWQnXSA/PyAwKTsKICAgICAgICAg
ICAgICAgICRwcmVjaW9Vbml0ICA9IChmbG9hdCkoJHByb2R1Y3RvLT5wcmVjaW9f
dmVudGEgPz8gMCk7CiAgICAgICAgICAgICAgICAvLyBQdWVkZXMgaWdub3JhciBl
bCBzdWJ0b3RhbCBkZWwgZnJvbnQgeSBjYWxjdWxhcmxvIGFxdcOtOgogICAgICAg
ICAgICAgICAgJHN1YnRvdGFsICAgID0gcm91bmQobWF4KDAsICRwcmVjaW9Vbml0
ICogJGNhbnRpZGFkIC0gJGRlc2N1ZW50byksIDIpOwoKICAgICAgICAgICAgICAg
IERldGFsbGVWZW50YTo6Y3JlYXRlKFsKICAgICAgICAgICAgICAgICAgICAnaWRf
dmVudGEnICAgICAgICA9PiAkdmVudGEtPmlkLAogICAgICAgICAgICAgICAgICAg
ICdpZF9wcm9kdWN0bycgICAgID0+ICRwcm9kdWN0by0+aWQsCiAgICAgICAgICAg
ICAgICAgICAgJ2NhbnRpZGFkJyAgICAgICAgPT4gJGNhbnRpZGFkLAogICAgICAg
ICAgICAgICAgICAgICdwcmVjaW9fdW5pdGFyaW8nID0+IHJvdW5kKCRwcmVjaW9V
bml0LCAyKSwKICAgICAgICAgICAgICAgICAgICAnZGVzY3VlbnRvJyAgICAgICA9
PiByb3VuZCgkZGVzY3VlbnRvLCAyKSwKICAgICAgICAgICAgICAgICAgICAnc3Vi
dG90YWwnICAgICAgICA9PiAkc3VidG90YWwsCiAgICAgICAgICAgICAgICBdKTsK
CiAgICAgICAgICAgICAgICAvLyBTdG9jayAocGVybWl0aWVuZG8gbmVnYXRpdm8p
CiAgICAgICAgICAgICAgICAkcHJvZHVjdG8tPnN0b2NrID0gKGludCkkcHJvZHVj
dG8tPnN0b2NrIC0gJGNhbnRpZGFkOwogICAgICAgICAgICAgICAgJHByb2R1Y3Rv
LT5zYXZlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFJlY2FsY3Vs
YXIgdG90YWwgZGVzZGUgQkQgKHZlcmRhZCDDum5pY2EpCiAgICAgICAgICAgICR2
ZW50YS0+dG90YWwgPSAoZmxvYXQpIERldGFsbGVWZW50YTo6d2hlcmUoJ2lkX3Zl
bnRhJywgJHZlbnRhLT5pZCktPnN1bSgnc3VidG90YWwnKTsKICAgICAgICAgICAg
JHZlbnRhLT5zYXZlKCk7CgogICAgICAgICAgICAvLyAzKSBBQ1RVQUxJWkFSIENB
SkEgZGVsIHVzdWFyaW8gZGVudHJvIGRlIGxhIG1pc21hIHRyYW5zYWNjacOzbgog
ICAgICAgICAgICAkbW9udG9DYWphID0gJHZlbnRhLT50b3RhbDsKICAgICAgICAg
ICAgJGNhamEgPSBDYWphOjp3aGVyZSgnaWRfdXNlcicsIGF1dGgoKS0+aWQoKSkK
ICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VzdGFkbycsICdBYmllcnRhJykKICAg
ICAgICAgICAgICAgIC0+bG9ja0ZvclVwZGF0ZSgpICAgICAgICAgICAgICAvLyBl
dml0YSBjb25kaWNpb25lcyBkZSBjYXJyZXJhCiAgICAgICAgICAgICAgICAtPmxh
dGVzdCgnaWRfY2FqYScpCiAgICAgICAgICAgICAgICAtPmZpcnN0KCk7CgogICAg
ICAgICAgICBpZiAoISRjYWphKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBWYWxp
ZGF0aW9uRXhjZXB0aW9uOjp3aXRoTWVzc2FnZXMoWwogICAgICAgICAgICAgICAg
ICAgICdjYWphJyA9PiBbJ05vIHRpZW5lcyB1bmEgY2FqYSBhYmllcnRhIHBhcmEg
cmVnaXN0cmFyIGVzdGEgdmVudGEuJ10sCiAgICAgICAgICAgICAgICBdKTsKICAg
ICAgICAgICAgfQogICAgICAgICAgICAkY2FqYS0+bW9udG9fdG90YWwgPSByb3Vu
ZCgkY2FqYS0+bW9udG9fdG90YWwgKyAkbW9udG9DYWphLCAyKTsKICAgICAgICAg
ICAgJGNhamEtPnNhdmUoKTsKCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKCiAg
ICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAg
ICAgICdvaycgICAgICAgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdtZXNzYWdl
JyAgPT4gJ1ZlbnRhIGNyZWFkYSBjb3JyZWN0YW1lbnRlJywKICAgICAgICAgICAg
ICAgICd2ZW50YV9pZCcgPT4gJHZlbnRhLT5pZCwKICAgICAgICAgICAgICAgICd0
b3RhbCcgICAgPT4gbnVtYmVyX2Zvcm1hdCgkdmVudGEtPnRvdGFsLCAyKSwKICAg
ICAgICAgICAgICAgICdjcmVhZG9zJyAgPT4gY291bnQoJGRhdGFbJ2l0ZW1zJ10p
LAogICAgICAgICAgICBdLCAyMDEpOwoKICAgICAgICB9IGNhdGNoIChUaHJvd2Fi
bGUgJGUpIHsKICAgICAgICAgICAgREI6OnJvbGxCYWNrKCk7CiAgICAgICAgICAg
IExvZzo6ZXJyb3IoJ1ZFTlRBUy5zdG9yZSBFUlJPUicsIFsnbXNnJyA9PiAkZS0+
Z2V0TWVzc2FnZSgpLCAndHJhY2UnID0+ICRlLT5nZXRUcmFjZUFzU3RyaW5nKCld
KTsKICAgICAgICAgICAgLy8gU2kgZXMgZXJyb3IgZGUgdmFsaWRhY2nDs24gbWFu
dWFsLCBMYXJhdmVsIGxvIGZvcm1hdGVhOyBwYXJhIG90cm9zLCA1MDA6CiAgICAg
ICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAg
ICdvaycgICAgICA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9
PiAnTm8gc2UgcHVkbyBjcmVhciBsYSB2ZW50YTogJy4kZS0+Z2V0TWVzc2FnZSgp
LAogICAgICAgICAgICBdLCA1MDApOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs
aWMgZnVuY3Rpb24gdXBkYXRlKFJlcXVlc3QgJHJlcXVlc3QsICRpZCkKICAgIHsK
ICAgICAgICBMb2c6OmluZm8oJ1ZlbnRhQ29udHJvbGxlckB1cGRhdGUgZWplY3V0
YWRvJywgWyd2ZW50YV9pZCcgPT4gJGlkLCAncGF5bG9hZCcgPT4gJHJlcXVlc3Qt
PmFsbCgpXSk7CiAgICAgICAgJHJlcXVlc3QtPmhlYWRlcnMtPnNldCgnQWNjZXB0
JywgJ2FwcGxpY2F0aW9uL2pzb24nKTsKCiAgICAgICAgJHZhbGlkYXRvciA9IFZh
bGlkYXRvcjo6bWFrZSgkcmVxdWVzdC0+YWxsKCksIFsKICAgICAgICAgICAgJ2Ns
aWVudGVfaWQnICAgICA9PiAncmVxdWlyZWR8ZXhpc3RzOmNsaWVudGVzLGlkJywK
ICAgICAgICAgICAgJ21ldG9kb19wYWdvX2lkJyA9PiAncmVxdWlyZWR8ZXhpc3Rz
Om1ldG9kb3NfcGFnbyxpZCcsCiAgICAgICAgICAgICd0b3RhbCcgICAgICAgICAg
PT4gJ3JlcXVpcmVkfG51bWVyaWN8bWluOjAnLCAvLyBzZSB2YWxpZGEsIHBlcm8g
Tk8gc2UgY29uZsOtYSBwYXJhIGd1YXJkYXIKICAgICAgICAgICAgJ251ZXZvcycg
ICAgICAgICA9PiAnYXJyYXknLAogICAgICAgICAgICAnZWRpdGFkb3MnICAgICAg
ID0+ICdhcnJheScsCiAgICAgICAgICAgICdlbGltaW5hZG9zJyAgICAgPT4gJ2Fy
cmF5JywKICAgICAgICBdKTsKICAgICAgICBpZiAoJHZhbGlkYXRvci0+ZmFpbHMo
KSkgewogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAg
ICAgICAgICAgICAnb2snICAgICAgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAn
bWVzc2FnZScgPT4gJ1JldmlzYSBsb3MgY2FtcG9zIGRlbCBmb3JtdWxhcmlvLics
CiAgICAgICAgICAgICAgICAnZXJyb3JzJyAgPT4gJHZhbGlkYXRvci0+ZXJyb3Jz
KCksCiAgICAgICAgICAgIF0sIDQyMik7CiAgICAgICAgfQoKICAgICAgICAvLyBO
b3JtYWxpemEgYXJyYXlzCiAgICAgICAgJG51ZXZvcyAgICAgPSAkcmVxdWVzdC0+
aW5wdXQoJ251ZXZvcycsIFtdKTsKICAgICAgICAkZWRpdGFkb3MgICA9ICRyZXF1
ZXN0LT5pbnB1dCgnZWRpdGFkb3MnLCBbXSk7CiAgICAgICAgJGVsaW1pbmFkb3Mg
PSAkcmVxdWVzdC0+aW5wdXQoJ2VsaW1pbmFkb3MnLCBbXSk7CgogICAgICAgIERC
OjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg
Ly8gQmxvcXVlbyBwZXNpbWlzdGEgcGFyYSBjb2hlcmVuY2lhIGVuIHN0b2NrCiAg
ICAgICAgICAgICR2ZW50YSA9IFZlbnRhOjpsb2NrRm9yVXBkYXRlKCktPmZpbmRP
ckZhaWwoJGlkKTsKCiAgICAgICAgICAgIC8vIEFjdHVhbGl6YSBjYWJlY2VyYSAo
Tk8gdG9xdWVzICd0b3RhbCcgYcO6bikKICAgICAgICAgICAgJHZlbnRhLT5jbGll
bnRlX2lkICAgICA9IChpbnQpJHJlcXVlc3QtPmNsaWVudGVfaWQ7CiAgICAgICAg
ICAgICR2ZW50YS0+bWV0b2RvX3BhZ29faWQgPSAoaW50KSRyZXF1ZXN0LT5tZXRv
ZG9fcGFnb19pZDsKICAgICAgICAgICAgJHZlbnRhLT5zYXZlKCk7CgogICAgICAg
ICAgICAvLyAxKSBFTElNSU5BRE9TOiBkZXZvbHZlciBzdG9jayB5IGJvcnJhciBk
ZXRhbGxlCiAgICAgICAgICAgICRuRWxpbWluYWRvcyA9IDA7CiAgICAgICAgICAg
IGlmICghZW1wdHkoJGVsaW1pbmFkb3MpKSB7CiAgICAgICAgICAgICAgICBmb3Jl
YWNoICgkZWxpbWluYWRvcyBhcyAkZGV0YWxsZUlkKSB7CiAgICAgICAgICAgICAg
ICAgICAgJGRldGFsbGUgPSBEZXRhbGxlVmVudGE6OmxvY2tGb3JVcGRhdGUoKS0+
ZmluZCgoaW50KSRkZXRhbGxlSWQpOwogICAgICAgICAgICAgICAgICAgIGlmICgk
ZGV0YWxsZSkgewogICAgICAgICAgICAgICAgICAgICAgICAkcHJvZHVjdG8gPSBQ
cm9kdWN0bzo6bG9ja0ZvclVwZGF0ZSgpLT5maW5kKCRkZXRhbGxlLT5pZF9wcm9k
dWN0byk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcHJvZHVjdG8pIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwcm9kdWN0by0+aW5jcmVtZW50
KCdzdG9jaycsIChpbnQpJGRldGFsbGUtPmNhbnRpZGFkKTsKICAgICAgICAgICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAkZGV0YWxsZS0+
ZGVsZXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRuRWxpbWluYWRvcysr
OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgfQoKICAgICAgICAgICAgLy8gMikgRURJVEFET1M6IGFqdXN0YXIgc3Rv
Y2sgcG9yIGRpZmVyZW5jaWEgeSByZWNhbGN1bGFyIHN1YnRvdGFsIGVuIHNlcnZp
ZG9yCiAgICAgICAgICAgICRuQWN0dWFsaXphZG9zID0gMDsKICAgICAgICAgICAg
aWYgKCFlbXB0eSgkZWRpdGFkb3MpKSB7CiAgICAgICAgICAgICAgICBmb3JlYWNo
ICgkZWRpdGFkb3MgYXMgJGVkaXQpIHsKICAgICAgICAgICAgICAgICAgICAkZGV0
YWxsZSA9IERldGFsbGVWZW50YTo6bG9ja0ZvclVwZGF0ZSgpLT5maW5kKChpbnQp
KCRlZGl0WydkZXRhbGxlX2lkJ10gPz8gMCkpOwogICAgICAgICAgICAgICAgICAg
IGlmICghJGRldGFsbGUpIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgICAgICAk
cHJvZHVjdG8gPSBQcm9kdWN0bzo6bG9ja0ZvclVwZGF0ZSgpLT5maW5kKChpbnQp
KCRlZGl0Wydwcm9kdWN0b19pZCddID8/IDApKTsKICAgICAgICAgICAgICAgICAg
ICBpZiAoISRwcm9kdWN0bykgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJv
dyBuZXcgXFJ1bnRpbWVFeGNlcHRpb24oIlByb2R1Y3RvIG5vIGVuY29udHJhZG8g
cGFyYSBlbCBkZXRhbGxlIHskZWRpdFsnZGV0YWxsZV9pZCddfS4iKTsKICAgICAg
ICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRjYW50aWRhZF9u
dWV2YSAgICAgPSAoaW50KSgkZWRpdFsnY2FudGlkYWRfbnVldmEnXSA/PyAwKTsK
ICAgICAgICAgICAgICAgICAgICAkY2FudGlkYWRfb3JpZ2luYWwgID0gKGludCko
JGVkaXRbJ2NhbnRpZGFkX29yaWdpbmFsJ10gPz8gMCk7CiAgICAgICAgICAgICAg
ICAgICAgJHByZWNpbyAgICAgICAgICAgICA9IChmbG9hdCkoJGVkaXRbJ3ByZWNp
byddID8/IDApOwogICAgICAgICAgICAgICAgICAgICRkZXNjdWVudG8gICAgICAg
ICAgPSAoZmxvYXQpKCRlZGl0WydkZXNjdWVudG8nXSA/PyAwKTsKCiAgICAgICAg
ICAgICAgICAgICAgJGRpZmYgPSAkY2FudGlkYWRfbnVldmEgLSAkY2FudGlkYWRf
b3JpZ2luYWw7IC8vID4wIHJlc3RhIG3DoXMgc3RvY2ssIDwwIGRldnVlbHZlCiAg
ICAgICAgICAgICAgICAgICAgaWYgKCRkaWZmID4gMCAmJiAkcHJvZHVjdG8tPnN0
b2NrIDwgJGRpZmYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3
IFxSdW50aW1lRXhjZXB0aW9uKCJTdG9jayBpbnN1ZmljaWVudGUgZGVsIHByb2R1
Y3RvIHskcHJvZHVjdG8tPmlkfSAoK3skZGlmZn0pLiIpOwogICAgICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkcHJvZHVjdG8tPnN0b2NrIC09
ICRkaWZmOwogICAgICAgICAgICAgICAgICAgICRwcm9kdWN0by0+c2F2ZSgpOwoK
ICAgICAgICAgICAgICAgICAgICAvLyBTdWJ0b3RhbCA9IHByZWNpbyAqIGNhbnRp
ZGFkIC0gZGVzY3VlbnRvIChubyBuZWdhdGl2byksIGNhbGN1bGFkbyBlbiBiYWNr
ZW5kCiAgICAgICAgICAgICAgICAgICAgJHN1YnRvdGFsID0gcm91bmQobWF4KDAs
ICgkcHJlY2lvICogJGNhbnRpZGFkX251ZXZhKSAtICRkZXNjdWVudG8pLCAyKTsK
CiAgICAgICAgICAgICAgICAgICAgJGRldGFsbGUtPmNhbnRpZGFkICAgICAgICA9
ICRjYW50aWRhZF9udWV2YTsKICAgICAgICAgICAgICAgICAgICAkZGV0YWxsZS0+
cHJlY2lvX3VuaXRhcmlvID0gJHByZWNpbzsKICAgICAgICAgICAgICAgICAgICAk
ZGV0YWxsZS0+ZGVzY3VlbnRvICAgICAgID0gJGRlc2N1ZW50bzsKICAgICAgICAg
ICAgICAgICAgICAkZGV0YWxsZS0+c3VidG90YWwgICAgICAgID0gJHN1YnRvdGFs
OwogICAgICAgICAgICAgICAgICAgICRkZXRhbGxlLT5zYXZlKCk7CgogICAgICAg
ICAgICAgICAgICAgICRuQWN0dWFsaXphZG9zKys7CiAgICAgICAgICAgICAgICB9
CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIDMpIE5VRVZPUzogY3JlYXIg
ZGV0YWxsZSwgZGVzY29udGFyIHN0b2NrIHkgY2FsY3VsYXIgc3VidG90YWwgZW4g
YmFja2VuZAogICAgICAgICAgICAkbkNyZWFkb3MgPSAwOwogICAgICAgICAgICBp
ZiAoIWVtcHR5KCRudWV2b3MpKSB7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgk
bnVldm9zIGFzICRudWV2bykgewogICAgICAgICAgICAgICAgICAgICRwcm9kdWN0
byA9IFByb2R1Y3RvOjpsb2NrRm9yVXBkYXRlKCktPmZpbmQoKGludCkoJG51ZXZv
Wydwcm9kdWN0b19pZCddID8/IDApKTsKICAgICAgICAgICAgICAgICAgICBpZiAo
ISRwcm9kdWN0bykgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcg
XFJ1bnRpbWVFeGNlcHRpb24oIlByb2R1Y3RvIG5vIGVuY29udHJhZG8gcGFyYSBj
cmVhciBkZXRhbGxlLiIpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAg
ICAgICAgICAgICAgJGNhbnRpZGFkICA9IChpbnQpKCRudWV2b1snY2FudGlkYWQn
XSA/PyAwKTsKICAgICAgICAgICAgICAgICAgICAkcHJlY2lvICAgID0gKGZsb2F0
KSgkbnVldm9bJ3ByZWNpbyddID8/IDApOwogICAgICAgICAgICAgICAgICAgICRk
ZXNjdWVudG8gPSAoZmxvYXQpKCRudWV2b1snZGVzY3VlbnRvJ10gPz8gMCk7Cgog
ICAgICAgICAgICAgICAgICAgIGlmICgkY2FudGlkYWQgPiAwICYmICRwcm9kdWN0
by0+c3RvY2sgPCAkY2FudGlkYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAg
dGhyb3cgbmV3IFxSdW50aW1lRXhjZXB0aW9uKCJTdG9jayBpbnN1ZmljaWVudGUg
ZGVsIHByb2R1Y3RvIHskcHJvZHVjdG8tPmlkfSAoK3skY2FudGlkYWR9KS4iKTsK
ICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRzdWJ0
b3RhbCA9IHJvdW5kKG1heCgwLCAoJHByZWNpbyAqICRjYW50aWRhZCkgLSAkZGVz
Y3VlbnRvKSwgMik7CgogICAgICAgICAgICAgICAgICAgICRkZXRhbGxlID0gRGV0
YWxsZVZlbnRhOjpjcmVhdGUoWwogICAgICAgICAgICAgICAgICAgICAgICAnaWRf
dmVudGEnICAgICAgICA9PiAkdmVudGEtPmlkLAogICAgICAgICAgICAgICAgICAg
ICAgICAnaWRfcHJvZHVjdG8nICAgICA9PiAoaW50KSRudWV2b1sncHJvZHVjdG9f
aWQnXSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NhbnRpZGFkJyAgICAgICAg
PT4gJGNhbnRpZGFkLAogICAgICAgICAgICAgICAgICAgICAgICAncHJlY2lvX3Vu
aXRhcmlvJyA9PiAkcHJlY2lvLAogICAgICAgICAgICAgICAgICAgICAgICAnZGVz
Y3VlbnRvJyAgICAgICA9PiAkZGVzY3VlbnRvLAogICAgICAgICAgICAgICAgICAg
ICAgICAnc3VidG90YWwnICAgICAgICA9PiAkc3VidG90YWwsCiAgICAgICAgICAg
ICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgICAgIGlmICgkY2FudGlkYWQg
PiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRwcm9kdWN0by0+ZGVjcmVt
ZW50KCdzdG9jaycsICRjYW50aWRhZCk7CiAgICAgICAgICAgICAgICAgICAgfQoK
ICAgICAgICAgICAgICAgICAgICAkbkNyZWFkb3MrKzsKICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gNCkgUmVjYWxjdWxhciBU
T1RBTCBkZXNkZSBCRCAodmVyZGFkIMO6bmljYSkKICAgICAgICAgICAgJHZlbnRh
LT50b3RhbCA9IChmbG9hdCkgRGV0YWxsZVZlbnRhOjp3aGVyZSgnaWRfdmVudGEn
LCAkdmVudGEtPmlkKS0+c3VtKCdzdWJ0b3RhbCcpOwogICAgICAgICAgICAkdmVu
dGEtPnNhdmUoKTsKCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKCiAgICAgICAg
ICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdv
aycgICAgICAgICAgID0+IHRydWUsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScg
ICAgICA9PiAnVmVudGEgYWN0dWFsaXphZGEgY29ycmVjdGFtZW50ZScsCiAgICAg
ICAgICAgICAgICAndmVudGFfaWQnICAgICA9PiAkdmVudGEtPmlkLAogICAgICAg
ICAgICAgICAgJ3RvdGFsJyAgICAgICAgPT4gbnVtYmVyX2Zvcm1hdCgkdmVudGEt
PnRvdGFsLCAyKSwKICAgICAgICAgICAgICAgICdjcmVhZG9zJyAgICAgID0+ICRu
Q3JlYWRvcywKICAgICAgICAgICAgICAgICdhY3R1YWxpemFkb3MnID0+ICRuQWN0
dWFsaXphZG9zLAogICAgICAgICAgICAgICAgJ2VsaW1pbmFkb3MnICAgPT4gJG5F
bGltaW5hZG9zLAogICAgICAgICAgICBdLCAyMDApOwoKICAgICAgICB9IGNhdGNo
IChUaHJvd2FibGUgJGUpIHsKICAgICAgICAgICAgREI6OnJvbGxCYWNrKCk7CiAg
ICAgICAgICAgIExvZzo6ZXJyb3IoJ1ZFTlRBUy51cGRhdGUgRVJST1InLCBbCiAg
ICAgICAgICAgICAgICAndmVudGFfaWQnID0+ICRpZCwKICAgICAgICAgICAgICAg
ICdtc2cnICAgICAgPT4gJGUtPmdldE1lc3NhZ2UoKSwKICAgICAgICAgICAgICAg
ICd0cmFjZScgICAgPT4gJGUtPmdldFRyYWNlQXNTdHJpbmcoKSwKICAgICAgICAg
ICAgXSk7CiAgICAgICAgICAgIC8vIHNpIHF1aWVyZXMgZGlzdGluZ3VpciBzdG9j
ayBpbnN1ZmljaWVudGUsIHBvZHLDrWFzIGRldm9sdmVyIDQwOQogICAgICAgICAg
ICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnb2sn
ICAgICAgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJ0Vy
cm9yIGFsIGFjdHVhbGl6YXI6ICcgLiAkZS0+Z2V0TWVzc2FnZSgpLAogICAgICAg
ICAgICBdLCA1MDApOwogICAgICAgIH0KICAgIH0KCgogICAgcHVibGljIGZ1bmN0
aW9uIGRlc3Ryb3koUmVxdWVzdCAkcmVxdWVzdCwgJGlkKQogICAgewogICAgICAg
IC8vIEZ1ZXJ6YSBKU09OIGVuIGxhcyByZXNwdWVzdGFzCiAgICAgICAgJHJlcXVl
c3QtPmhlYWRlcnMtPnNldCgnQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTsK
CiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnkgewog
ICAgICAgICAgICAvLyBUcmFlIGxhIHZlbnRhIGNvbiBzdXMgZGV0YWxsZXMKICAg
ICAgICAgICAgJHZlbnRhID0gVmVudGE6OndpdGgoJ2RldGFsbGVzJyktPmZpbmRP
ckZhaWwoJGlkKTsKCiAgICAgICAgICAgIC8vIFJlcG9uZXIgc3RvY2sgeSBib3Jy
YXIgZGV0YWxsZXMKICAgICAgICAgICAgZm9yZWFjaCAoJHZlbnRhLT5kZXRhbGxl
cyBhcyAkZGV0YWxsZSkgewogICAgICAgICAgICAgICAgLy8gdHVzIGNvbHVtbmFz
OiBpZF9wcm9kdWN0bywgY2FudGlkYWQKICAgICAgICAgICAgICAgICRwcm9kdWN0
byA9IFByb2R1Y3RvOjpsb2NrRm9yVXBkYXRlKCktPmZpbmQoJGRldGFsbGUtPmlk
X3Byb2R1Y3RvKTsKICAgICAgICAgICAgICAgIGlmICgkcHJvZHVjdG8pIHsKICAg
ICAgICAgICAgICAgICAgICAkcHJvZHVjdG8tPnN0b2NrICs9IChpbnQpJGRldGFs
bGUtPmNhbnRpZGFkOwogICAgICAgICAgICAgICAgICAgICRwcm9kdWN0by0+c2F2
ZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGRldGFsbGUt
PmRlbGV0ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBCb3JyYSBs
YSB2ZW50YQogICAgICAgICAgICAkdmVudGEtPmRlbGV0ZSgpOwoKICAgICAgICAg
ICAgREI6OmNvbW1pdCgpOwoKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCkt
Pmpzb24oWwogICAgICAgICAgICAgICAgJ29rJyAgICAgICA9PiB0cnVlLAogICAg
ICAgICAgICAgICAgJ21lc3NhZ2UnICA9PiAnVmVudGEgZWxpbWluYWRhIGNvcnJl
Y3RhbWVudGUuJywKICAgICAgICAgICAgICAgICd2ZW50YV9pZCcgPT4gKGludCkk
aWQsCiAgICAgICAgICAgIF0sIDIwMCk7CgogICAgICAgIH0gY2F0Y2ggKFRocm93
YWJsZSAkZSkgewogICAgICAgICAgICBEQjo6cm9sbEJhY2soKTsKICAgICAgICAg
ICAgTG9nOjplcnJvcignVkVOVEFTLmRlc3Ryb3kgRVJST1InLCBbJ3ZlbnRhX2lk
JyA9PiAkaWQsICdtc2cnID0+ICRlLT5nZXRNZXNzYWdlKCldKTsKCiAgICAgICAg
ICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdv
aycgICAgICA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAn
Tm8gc2UgcHVkbyBlbGltaW5hciBsYSB2ZW50YTogJy4kZS0+Z2V0TWVzc2FnZSgp
LAogICAgICAgICAgICBdLCA1MDApOwogICAgICAgIH0KICAgIH0KfQo=
-----END CERTIFICATE-----
